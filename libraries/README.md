# Faust Libraries Update
This repository contains a fully rewritten version of the Faust libraries. The goals of this project are to:

* document the libraries using the `faust2md` system,
* standardize the libraries by factorizing their code, getting rid of duplicates, and establishing coding coventions,
* organize their different functions in a clear hierarchical manner,
* add missing standard functions,
* reorganize the `/examples` folder of the Faust repository.

## General Organization

This repository contains all the libraries (both the new libraries and the ones that were deprecated) that will need to be merged to the Faust repository. We tried to minimize the number of libraries to keep things easy for new users. Instead we created a wide range of sections in each of them. 

Only the libraries that are considered to be "standard" are documented:

* `analyzer.lib` 
* `basic.lib` 
* `delay.lib`
* `effect.lib`
* `envelope.lib`
* `filter.lib`
* `generator.lib`
* `hoa.lib`
* `math.lib`
* `pm.lib`
* `signal.lib`
* `spat.lib`
* `synth.lib`
* `tonestack.lib` (not documented but example in `/examples/misc`)
* `tube.lib` (not documented but example in `/examples/misc`)

Other deprecated libraries such as `music.lib`, etc. are present but are not documented to not confuse new users. 

The markdown documentation of each library is located in `/doc` and can be automatically generated by running `generateDoc`.

The `/examples` directory contains all the examples from the `/examples` folder of the Faust distribution as well as new ones. Most of them were updated to reflect the coding conventions described in the next section. Examples are organized by types in different folders. The `/old` folder contains examples that are fully deprecated, probably because they were integrated to the libraries and fully rewritten (see `freeverb.dsp` for example). Examples using deprecated libraries were integrated to the general tree but a warning comment was added at their beginning to point readers to the right library and function.

## Deployment Suggestion

After beta testing, we suggest the creation of a `/libraries` or `/libs` folder at the root of Faust's source code where all the libraries available here would be placed. We believe that this would make things easier to understand for new users instead of having the libraries mixed with various C++ files in the `/architecture` folder. 

The `/doc` folder could be added to the `libraries` folder or moved to the `/documentation` of the Faust distribution under a `/libraries` sub-folder which would probably make more sense. 

The `/examples` folder available here would replace the one of the Faust distribution. 

The `makefile` of the Faust distribution will have to be adapted to take these changes into account. In particular, many "`demo`" functions are now implemented as independant `.dsp` files in the `/examples` folder (see the section on *Coding Conventions / Demo Functions*) which means that this folder should be installed in `/usr/local/lib/faust` along with the libraries to not break anything...  

## Coding Conventions

In order to have a uniformized library system, we established the following conventions (that hopefully will be followed by others when making modifications to them :-) ).

### Documentation

* All the functions that we want to be "public" are documented.
* We used the `faust2md` "standards" for each library: `//###` for main title (library name - equivalent to `#` in markdown), `//===` for section declarations (equivalent to `##` in markdown) and `//---` for function declarations (equivalent to `####` in markdown - see `basic.lib` for an example).
* Sections in function documentation should be declared as `####` markdown title.
* Each function documentation provides a "Usage" section (see `basic.lib`). 

### Library Import

To prevent cross-references between libraries we generalized the use of the `library("")` system for function calls in all the libraries. This means that everytime a function declared in another library is called, the environment corresponding to this library needs to be called too. To make things easier, a `stdfaust.lib` library was created and is imported by all the libraries:

```
ma = library("math.lib");
ba = library("basic.lib");
de = library("delay.lib");
en = library("envelope.lib");
si = library("signal.lib");
an = library("analyzer.lib");
fi = library("filter.lib");
ge = library("generator.lib");
ho = library("hoa.lib");
sp = library("spat.lib");
sy = library("synth.lib");
ef = library("effect.lib");
```

For example, if we wanted to use the `smooth` function which is now declared in `signal.lib`, we would do the following:

```
import("stdfaust.lib");

process = si.smooth(0.999);
```

This standard is only used within the libraries: nothing prevents coders to still import `signal.lib` directly and call `smooth` without `si.`, etc.

### "Demo" Functions

All the functions that were present in the libraries and that contained any kind of UI elements declaration (mostly JOS "`demo`" functions) were turned into independant `.dsp` files that were placed in the `/examples` folder. Thus, Faust libraries now only contain "pure" function declarations which should make them more legible. Also, "`demo`" functions make great examples... 

For practicality, the "`demo`" functions are still declared in the various libraries but as "components" pointing at the `/examples` folder (which is why that folder will have to be installed on the system during the installation process of the Faust distribution).

## Deprecated Libraries and Backward Compatibility

The following libraries were deprecated but are still present and should still work:

* A set of libraries starting with the `old_` prefix were created and should be used with old Faust codes when calling the "old" version of `filter.lib`, `effect.lib`, etc. All these `old_` libraries import `old_all.lib` which basically imports all the new libraries in a single library...stdfaust.lib
* `music.lib`: some of the elements of this library were moved in other libraries and some elements were just discarded. Discarded elements are still implemented in the library (open `music.lib` to see how it works).
* `maxmsp.lib`: this library is too similar too `filter.lib` which is why it was "deprecated".
* `reduce.lib`: I imagine this library could be made a standard one or just integrated to existing libraries: any thoughts?

## The question of licensing/authoring/copyrigth
Now that Faust libraries are not author specific, each function will be able to have its own licence/author declaration. This means that some libraries wont have a global licence/author/copyright declaration like it used to be the case.