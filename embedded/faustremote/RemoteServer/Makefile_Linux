#####################
# LINUX COMPILATION
#####################

CC            = gcc -g
CXX           = g++ -g
DEFINE	      = D_REENTRANT	
LINK          = g++
LLVM_CONFIG   = llvm-config

INCPATH       = -I. -I/usr/include -I. -I/opt/local/include -I. -F/Library/Frameworks -I/usr/include/dbus-1.0 -I/usr/lib/x86_64-linux-gnu/dbus-1.0/include   -DDBUS_VERSION_MAJOR=1 -DDBUS_VERSION_MINOR=4 -DDBUS_VERSION_MICRO=18 -DDBUS_API_SUBJECT_TO_CHANGE

LIBS          = -L/usr/local/lib/faust -lfaust -lHTTPDFaust -ljacknet -ljack -L/opt/local/lib -lmicrohttpd -lpthread -lcrypto `$(LLVM_CONFIG) --ldflags` `$(LLVM_CONFIG) --libs` -ldl -ldbus-1 -lpthread -lrt -ldaemon

DESTDIR       = 
TARGET        = ./RemoteServer
####### Files

SOURCES       = Server.cpp main.cpp ../utilities.cpp linux_server/client-publish-service.c linux_server/avahi-client/client.c linux_server/avahi-common/alternative.c linux_server/avahi-common/simple-watch.c linux_server/avahi-common/malloc.c linux_server/avahi-common/error.c linux_server/avahi-common/timeval.c linux_server/avahi-common/cdecl.c linux_server/avahi-common/address.c linux_server/avahi-common/strlst.c linux_server/avahi-common/defs.c linux_server/avahi-common/watch.c linux_server/avahi-common/gccmacro.c linux_server/avahi-common/domain.c linux_server/avahi-common/utf8.c linux_server/avahi-common/i18n.c linux_server/avahi-common/dbus.c linux_server/avahi-common/dbus-watch-glue.c linux_server/avahi-client/browser.c linux_server/avahi-client/xdg-open.c linux_server/avahi-client/resolver.c linux_server/avahi-client/entrygroup.c
				 
OBJECTS       = Server.o main.o utilities.o client-publish-service.o client.o alternative.o simple-watch.o malloc.o error.o timeval.o address.o strlst.o domain.o utf8.o i18n.o dbus.o dbus-watch-glue.o browser.o xdg-config.o resolver.o entrygroup.o

first: all

####### Build rules

all: Makefile $(TARGET)

$(TARGET):  $(OBJECTS)
			$(LINK) $(LFLAGS) -o $(TARGET) $(OBJECTS) $(OBJCOMP) $(LIBS)

clean: 
	rm -f $(OBJECTS)
	rm -f $(TARGET)

####### Compile

Server.o: Server.cpp Server.h ../TMutex.h linux_server/client-publish-service.h
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o Server.o Server.cpp

main.o: main.cpp Server.h
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o main.o main.cpp

utilities.o: ../utilities.h
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o utilities.o ../utilities.cpp

####### Compile

client-publish-service.o: linux_server/client-publish-service.c linux_server/client-publish-service.h linux_server/avahi-client/client.h linux_server/avahi-client/publish.h linux_server/avahi-common/alternative.h linux_server/avahi-common/simple-watch.h linux_server/avahi-common/malloc.h linux_server/avahi-common/error.h linux_server/avahi-common/timeval.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o client-publish-service.o linux_server/client-publish-service.c

client.o: linux_server/avahi-client/client.c linux_server/avahi-client/client.h linux_server/avahi-common/cdecl.h linux_server/avahi-common/address.h linux_server/avahi-common/strlst.h linux_server/avahi-common/defs.h linux_server/avahi-common/watch.h linux_server/avahi-common/gccmacro.h linux_server/avahi-common/dbus.h linux_server/avahi-common/llist.h linux_server/avahi-common/error.h linux_server/avahi-common/malloc.h linux_server/avahi-common/dbus-watch-glue.h linux_server/avahi-common/i18n.h linux_server/avahi-client/internal.h linux_server/avahi-client/browser.c
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o client.o linux_server/avahi-client/client.c

alternative.o: linux_server/avahi-common/alternative.h linux_server/avahi-common/alternative.c linux_server/avahi-common/cdecl.h linux_server/avahi-common/malloc.h linux_server/avahi-common/domain.h linux_server/avahi-common/utf8.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o alternative.o linux_server/avahi-common/alternative.c

simple-watch.o: linux_server/avahi-common/simple-watch.h linux_server/avahi-common/simple-watch.c linux_server/avahi-common/cdecl.h linux_server/avahi-common/watch.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o simple-watch.o linux_server/avahi-common/simple-watch.c

malloc.o: linux_server/avahi-common/malloc.h linux_server/avahi-common/cdecl.h linux_server/avahi-common/gccmacro.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o malloc.o linux_server/avahi-common/malloc.c

error.o: linux_server/avahi-common/error.h linux_server/avahi-common/error.c linux_server/avahi-common/cdecl.h linux_server/avahi-common/i18n.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o error.o linux_server/avahi-common/error.c

timeval.o: linux_server/avahi-common/timeval.h linux_server/avahi-common/timeval.c linux_server/avahi-common/cdecl.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o timeval.o linux_server/avahi-common/timeval.c

address.o: linux_server/avahi-common/address.h linux_server/avahi-common/address.c linux_server/avahi-common/cdecl.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o address.o linux_server/avahi-common/address.c

strlst.o: linux_server/avahi-common/strlst.h linux_server/avahi-common/strlst.c linux_server/avahi-common/cdecl.h linux_server/avahi-common/gccmacro.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o strlst.o linux_server/avahi-common/strlst.c

domain.o: linux_server/avahi-common/domain.h linux_server/avahi-common/domain.c linux_server/avahi-common/malloc.h linux_server/avahi-common/error.h linux_server/avahi-common/address.h linux_server/avahi-common/utf8.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o domain.o linux_server/avahi-common/domain.c

utf8.o: linux_server/avahi-common/utf8.h linux_server/avahi-common/utf8.c linux_server/avahi-common/cdecl.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o utf8.o linux_server/avahi-common/utf8.c

i18n.o: linux_server/avahi-common/i18n.h linux_server/avahi-common/i18n.c
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o i18n.o linux_server/avahi-common/i18n.c 

dbus.o: linux_server/avahi-common/dbus.c linux_server/avahi-common/dbus.c linux_server/avahi-common/cdecl.h linux_server/avahi-common/error.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o dbus.o linux_server/avahi-common/dbus.c

dbus-watch-glue.o: linux_server/avahi-common/dbus-watch-glue.c linux_server/avahi-common/dbus-watch-glue.c linux_server/avahi-common/malloc.h linux_server/avahi-common/timeval.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o dbus-watch-glue.o linux_server/avahi-common/dbus-watch-glue.c 

browser.o: linux_server/avahi-client/browser.c linux_server/avahi-common/dbus.h linux_server/avahi-common/llist.h linux_server/avahi-common/error.h linux_server/avahi-common/malloc.h linux_server/avahi-common/domain.h linux_server/avahi-client/client.h linux_server/avahi-client/internal.h linux_server/avahi-client/xdg-config.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o browser.o linux_server/avahi-client/browser.c 

xdg-config.o: linux_server/avahi-client/xdg-config.c linux_server/avahi-client/xdg-config.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o xdg-config.o linux_server/avahi-client/xdg-config.c

resolver.o: linux_server/avahi-client/resolver.c linux_server/avahi-client/lookup.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o resolver.o linux_server/avahi-client/resolver.c

entrygroup.o: linux_server/avahi-client/entrygroup.c linux_server/avahi-client/lookup.h
	$(CC) -c $(CXXFLAGS) $(INCPATH) -o entrygroup.o linux_server/avahi-client/entrygroup.c

